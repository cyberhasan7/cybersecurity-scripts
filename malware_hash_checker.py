import hashlib
import sys

def calculate_hash(file_path):
    """Calculate SHA256 hash of a file"""
    sha256 = hashlib.sha256()
    try:
        with open(file_path, "rb") as f:
            for chunk in iter(lambda: f.read(4096), b""):
                sha256.update(chunk)
        return sha256.hexdigest()
    except FileNotFoundError:
        print(f"❌ File not found: {file_path}")
        sys.exit(1)
    except Exception as e:
        print(f"⚠️ Error: {e}")
        sys.exit(1)

def main():
    if len(sys.argv) != 2:
        print("Usage: python malware_hash_checker.py <file_path>")
        sys.exit(1)

    file_path = sys.argv[1]
    file_hash = calculate_hash(file_path)

    print(f"\n🧹 Malware Hash Checker")
    print(f"📂 File: {file_path}")
    print(f"🔑 SHA256: {file_hash}\n")
    print("👉 You can paste this hash in VirusTotal for malware analysis.")

if __name__ == "__main__":
    main()
